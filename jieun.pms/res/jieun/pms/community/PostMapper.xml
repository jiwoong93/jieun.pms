<?xml version="1.0" encoding="UTF-8" ?> 
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="jieun.pms.community.dao.mapper.PostMapper">
	
	<select id="getPosts" parameterType="page" resultMap="postMap">
		<![CDATA[
		select * from(
		select rownum as rnum, x.* from(
			select * from reviews
			order by rev_no desc
		)x where rownum <=#{rowCnt}*#{currentPage}
		)where rnum>#{rowCnt}*(#{currentPage}-1)
		]]>
	</select>
	
	<select id="getReview" parameterType="page" resultMap="postMap">
		<![CDATA[
		select rev_no, mem_id, rev_subject, rev_contents, rev_view
		from reviews
		where rev_no = #{revNo}		
		]]>
	</select>
	
	<insert id="insertReview" parameterType="review">
		insert into reviews
		values(revno_seq.nextval,#{memId,jdbcType=VARCHAR} , #{itemNo,jdbcType=VARCHAR},sysdate,#{revFilename,jdbcType=VARCHAR},#{revSubject,jdbcType=VARCHAR},#{revContents,jdbcType=VARCHAR},0)
	</insert>
	
	<delete id="deleteProduct" parameterType="int">
		delete items
		where rev_no = #{revNo}
	</delete>

	<resultMap id="postMap" type="post">
		<id property="revNo" column="rev_no" />
		<result property="subject" column="rev_subject" />
		<result property="contents" column="rev_contents" />
		<result property="regDate" column="rev_date" />
		<result property="view" column="rev_view" />
	</resultMap>
	
	<resultMap id="reviewMap" type="review">
		<id property="revNo" column="rev_no" />
		<result property="memId" column="rev_memid" />
		<result property="itemNo" column="rev_itemno" />
		<result property="revDate" column="rev_revdate" />
		<result property="revFilename" column="rev_revfilename" />
		<result property="revSubject" column="rev_revsubject" />
		<result property="revContents" column="rev_revcontents" />
		<result property="revView" column="rev_revview" />
	</resultMap>
</mapper>
